SELECT
  DISTINCT WPD.EMPL_BDGE_NUM AS PERSON_ID,
  SHIFT.UTC_DATE AS SHIFT_START_DATE,
  SHIFT.MINS AS SHIFT_DURATION
FROM EMCAS_ENGR_S360.GLOBAL_SCHEDULER_SHIFT SHIFT
  JOIN EMCAS_ENGR_S360.W_PERSON_D WPD ON SHIFT.PERSON_ID = WPD.PERS_11I_ID
WHERE
  (SHIFT.UTC_DATE, SHIFT.UTC_DATE + CAST(SHIFT.MINS/60-1 || 'HOURS' AS INTERVAL))
  OVERLAPS
  (NOW()::TIMESTAMP, NOW()::TIMESTAMP)
LIMIT 10;

SELECT
  DISTINCT SR.SRVC_REQ_NUM AS SR_NUM,
  WPD.EMPL_BDGE_NUM AS SR_OWNER_PERSON_ID,
  RSR.PERS_FIRST_NM AS FIRST_NAME,
  RSR.PERS_LAST_NM as LAST_NAME,
  SR.SRVC_REQ_PROB_TEXT AS PROBLEM_DESCRIPTION,
  SR.SRVC_REQ_CRTE_DT
FROM
  EMCAS_ENGR_S360.W_SERVICE_REQUEST_D AS SR,
  EMCAS_ENGR_S360.W_RESOURCE_ROLE_REF AS RSR,
  EMCAS_ENGR_S360.W_PERSON_D AS WPD
WHERE
  SR.SRVC_REQ_OWNR_RSRC_ID = RSR.RSRC_ID AND
  WPD.EMPL_BDGE_NUM != 'NA' AND
  RSR.PERS_11I_ID = WPD.PERS_11I_ID AND
  SR.SRVC_REQ_CRTE_DT > NOW()::timestamp - CAST(365 || 'DAYS' AS INTERVAL)
ORDER BY
  SR.srvc_req_crte_dt,
  SR_OWNER_PERSON_ID
LIMIT 1000;

